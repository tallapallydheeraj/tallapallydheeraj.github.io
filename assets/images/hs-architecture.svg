<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1400" height="820" viewBox="0 0 1400 820" role="img"
 aria-label="AWS Serverless Architecture: UI to API Gateway to Gateway Lambda (BFF) with conditional Step Functions orchestration">
  <defs>
    <style>
      .title { font: 700 22px system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; fill: #0f172a; }
      .subtitle { font: 500 14px system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; fill: #475569; }
      .label { font: 600 13px system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; fill: #0f172a; }
      .text { font: 500 12px system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; fill: #1f2937; }
      .small { font: 500 11px system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; fill: #334155; }
      .layer { fill: #f8fafc; stroke: #cbd5e1; stroke-width: 1.2; }
      .box { fill: #ffffff; stroke: #94a3b8; stroke-width: 1.2; }
      .accent { fill: #eef2ff; stroke: #6366f1; stroke-width: 1.2; }
      .accent2 { fill: #ecfeff; stroke: #06b6d4; stroke-width: 1.2; }
      .warn { fill: #fff7ed; stroke: #fb923c; stroke-width: 1.2; }
      .ok { fill: #ecfdf5; stroke: #10b981; stroke-width: 1.2; }
      .arrow { stroke: #334155; stroke-width: 1.6; fill: none; }
      .dashed { stroke-dasharray: 6 5; }
    </style>
    <marker id="arrowHead" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#334155"/>
    </marker>
  </defs>

  <!-- Header -->
  <text x="40" y="48" class="title">AWS Serverless Architecture Overview</text>
  <text x="40" y="74" class="subtitle">
    UI → API Gateway → Gateway Lambda (BFF) → Direct Response or Step Functions (JSONata) → AWS Services
  </text>

  <!-- User Interaction -->
  <rect x="30" y="100" width="360" height="260" rx="14" class="layer"/>
  <text x="50" y="128" class="label">1) User Interaction Layer</text>

  <rect x="60" y="160" width="300" height="80" rx="12" class="box"/>
  <text x="80" y="190" class="label">Users / Patients</text>
  <text x="80" y="214" class="small">Web-based interactions</text>

  <rect x="60" y="255" width="300" height="80" rx="12" class="accent2"/>
  <text x="80" y="285" class="label">Workspace / CRM Portal</text>
  <text x="80" y="307" class="small">Login · Scheduling · Verification · Orders</text>

  <!-- Frontend -->
  <rect x="420" y="100" width="320" height="260" rx="14" class="layer"/>
  <text x="440" y="128" class="label">2–3) Frontend Delivery &amp; Integration</text>

  <rect x="450" y="160" width="260" height="70" rx="12" class="box"/>
  <text x="470" y="192" class="label">CloudFront &amp; S3</text>
  <text x="470" y="214" class="small">Static UI modules</text>

  <rect x="450" y="245" width="260" height="60" rx="12" class="warn"/>
  <text x="470" y="278" class="label">Outbound / Inbound Comms</text>
  <text x="470" y="298" class="small">Genesys · PCAS · Legacy Events</text>

  <!-- API Gateway -->
  <rect x="770" y="100" width="300" height="260" rx="14" class="layer"/>
  <text x="790" y="128" class="label">4) API Gateway</text>

  <rect x="800" y="160" width="240" height="90" rx="12" class="accent"/>
  <text x="820" y="190" class="label">HS Gateway</text>
  <text x="820" y="214" class="small">Person · Prescription · Order · Encounter</text>

  <!-- Backend -->
  <rect x="1100" y="100" width="260" height="260" rx="14" class="layer"/>
  <text x="1120" y="128" class="label">5) Backend Services</text>

  <rect x="1120" y="160" width="220" height="70" rx="12" class="accent"/>
  <text x="1140" y="192" class="label">Gateway Lambda (BFF)</text>
  <text x="1140" y="214" class="small">Decision point</text>

  <rect x="1120" y="245" width="220" height="45" rx="12" class="ok"/>
  <text x="1140" y="272" class="label">Direct Response</text>

  <rect x="1120" y="300" width="220" height="45" rx="12" class="warn"/>
  <text x="1140" y="327" class="label">Invoke Step Functions</text>

  <!-- Step Functions -->
  <rect x="30" y="400" width="460" height="280" rx="14" class="accent2"/>
  <text x="50" y="430" class="label">Step Functions (JSONata)</text>
  <text x="50" y="452" class="small">Conditional orchestration · retries · branching</text>

  <rect x="60" y="480" width="180" height="55" rx="12" class="box"/>
  <text x="80" y="513" class="label">Common API Lambda</text>

  <rect x="260" y="480" width="180" height="55" rx="12" class="box"/>
  <text x="280" y="513" class="label">Service Lambdas</text>

  <!-- Data -->
  <rect x="520" y="400" width="420" height="280" rx="14" class="layer"/>
  <text x="540" y="430" class="label">6) Data Layer</text>

  <rect x="550" y="470" width="170" height="60" rx="12" class="box"/>
  <text x="565" y="505" class="label">DynamoDB</text>

  <rect x="740" y="470" width="170" height="60" rx="12" class="box"/>
  <text x="755" y="505" class="label">Parameter Store</text>

  <rect x="550" y="545" width="170" height="60" rx="12" class="box"/>
  <text x="565" y="580" class="label">Redis / Cache</text>

  <rect x="740" y="545" width="170" height="60" rx="12" class="box"/>
  <text x="755" y="580" class="label">Mongo CRUD Lambda</text>

  <rect x="740" y="615" width="170" height="45" rx="12" class="box"/>
  <text x="755" y="642" class="label">MongoDB / DB2</text>

  <!-- Monitoring -->
  <rect x="980" y="400" width="380" height="140" rx="14" class="warn"/>
  <text x="1000" y="430" class="label">8) Monitoring &amp; Security</text>
  <text x="1000" y="455" class="small">IAM · KMS · Secrets Manager</text>
  <text x="1000" y="475" class="small">CloudWatch · Dynatrace · Splunk</text>

  <!-- Arrows -->
  <path d="M 360 260 L 450 260" class="arrow" marker-end="url(#arrowHead)"/>
  <path d="M 710 260 L 800 260" class="arrow" marker-end="url(#arrowHead)"/>
  <path d="M 1040 260 L 1120 260" class="arrow" marker-end="url(#arrowHead)"/>
  <path d="M 1120 322 L 260 450" class="arrow" marker-end="url(#arrowHead)"/>
</svg>
